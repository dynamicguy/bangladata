{% extends "base.html" %}
{% block head %}
<link rel="stylesheet" type= "text/css" href= "{{ url_for('static',filename='css/parlelections.css') }}">
{{super()}}
{% endblock %}
{% block content %}
<!--info modals-->
<div class="modal fade" role="dialog" id="modal_about">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                <h4 class="modal-title">About The Map</h4>
            </div>
            <div class="modal-body">
                <p>These maps display parliamentary election results data from the 2001 and 2008 elections.
                  <br><br>
                  The Eighth National Parliamentary Elections were held on 1 October 2001.
                  The Bangladesh Nationalist Party-backed Four Party Alliance won 193 of 300 seats. Voter turnout was 75%
                  <br><br>
                  The Ninth National Parliamentary Elections were held on 29 December 2008.
                  The Awami League-backed Mohajote coalition won 262 of 300 seats. Voter turnout was 80%
                  <br><br>
                  The "Magnitude" maps highlight the magnitude of the victory by a coalition or party in each constituency in the 2001 and 2008 elections, respectively.
                  The larger the circle, the larger the margin of victory of the winning coalition or party over its nearest competitor.
                  <br><br>
                  The "Constituency" map displays the victories by coalition or party by constituency in the 2008 elections.
                  The darker the color, the larger the margin of victory of the winning coalition or party over its nearest competitor.
                  <br><br>
                  The "Swing" map displays the election constituencies that were decided by margins of victory of less than 10% in the 2008 elections.
                  The color of the constituency corresponds to the winning coalition or party.
                </p>
            </div>
            <div class="modal-footer"><button type="button" class="btn btn-default" data-dismiss="modal">Close</button></div>
        </div><!-- /.modal-content -->
    </div><!-- /.modal-dialog -->
</div><!-- /.modal -->
<!-- a Bootstrap modal, which we'll bind to the control via the modalId parameter -->
<div class="modal fade" role="dialog" id="modal_help">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                <h4 class="modal-title">About the Data</h4>
            </div>
            <div class="modal-body">
                <p>The data was compiled from the <a href="http://www.ec.org.bd/MenuExternalFilesEng/124.pdf" target="_blank">Eight Parliament Election Statistical Report (2001)</a>
                  and the <a href="http://www.ec.org.bd/MenuExternalFilesEng/304.pdf" target="_blank">Ninth Parliament Election Statistical Report (2008)</a>
                  published on the website of the <a href="http://www.ec.org.bd/" target="_blank">Election Commission of Bangladesh</a></p>
            <div class="modal-footer"><button type="button" class="btn btn-default" data-dismiss="modal">Close</button></div>
        </div><!-- /.modal-content -->
    </div><!-- /.modal-dialog -->
</div><!-- /.modal -->
{{super()}}
{% endblock %}

{% block scripts %}
<script src="{{ url_for('static', filename='data/results2001.json')}}"></script>
<script src="{{ url_for('static', filename='data/results2008.json')}}"></script>
<script src="{{ url_for('static', filename='data/results2008con.json')}}"></script>
<script src="{{ url_for('static', filename='data/swing.json')}}"></script>
<script src="{{ url_for('static', filename='js/results2001.js')}}"></script>
<script src="{{ url_for('static', filename='js/results2008.js')}}"></script>
<script src="{{ url_for('static', filename='js/results2008con.js')}}"></script>
<script src="{{ url_for('static', filename='js/swing.js')}}"></script>
<script>
$(document).ready(function() {
L.control.layers(baseLayers, null, {collapsed: true, position: 'topleft'}).addTo(map);
map.flyTo([24, 90], 7);
});

var results2001geojson;
var results2008geojson;
var results2008congeojson;
var swinggeojson;
//var markers

var overlayMaps = {
  "2001 Elections - Magnitude": results2001geojson,
  "2008 Elections - Magnitude": results2008geojson,
  "2008 Elections - Constituency": results2008congeojson,
  "2008 Elections - Swing": swinggeojson
};

map.addLayer(results2001geojson);
L.control.layers(overlayMaps, null, {collapsed: false, position: 'bottomleft'}).addTo(map);
results2001legend.addTo(map);
results2001info.addTo(map);
var currentLegend = results2001legend;
var currentInfo = results2001info;

map.on('baselayerchange', function(eventLayer) {
  if(eventLayer.name === '2001 Elections - Magnitude') {
    map.removeControl(currentLegend);
    currentLegend = results2001legend;
    results2001legend.addTo(map);
    map.removeControl(currentInfo);
    currentInfo = results2001info;
    results2001info.addTo(map);
  }
  else if(eventLayer.name === '2008 Elections - Magnitude') {
    map.removeControl(currentLegend);
    currentLegend = results2008legend;
    results2008legend.addTo(map);
    map.removeControl(currentInfo);
    currentInfo = results2008info;
    results2008info.addTo(map);
  }
  else if(eventLayer.name === '2008 Elections - Constituency') {
    map.removeControl(currentLegend);
    currentLegend = results2008conlegend;
    results2008conlegend.addTo(map);
    map.removeControl(currentInfo);
    currentInfo = results2008coninfo;
    results2008coninfo.addTo(map);
  }
  else if(eventLayer.name === '2008 Elections - Swing') {
    map.removeControl(currentLegend);
    currentLegend = swinglegend;
    swinglegend.addTo(map);
    map.removeControl(currentInfo);
    currentInfo = swinginfo;
    swinginfo.addTo(map);
  }
});
</script>
{{super()}}
{% endblock %}
